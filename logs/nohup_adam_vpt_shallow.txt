2023-06-06 01:31:12,971 [trainer.py] => config: ./exps/adam_vpt_shallow.json
2023-06-06 01:31:12,971 [trainer.py] => prefix:  
2023-06-06 01:31:12,971 [trainer.py] => dataset: cifar224
2023-06-06 01:31:12,971 [trainer.py] => memory_size: 0
2023-06-06 01:31:12,971 [trainer.py] => memory_per_class: 0
2023-06-06 01:31:12,971 [trainer.py] => fixed_memory: False
2023-06-06 01:31:12,972 [trainer.py] => shuffle: True
2023-06-06 01:31:12,972 [trainer.py] => init_cls: 10
2023-06-06 01:31:12,972 [trainer.py] => increment: 10
2023-06-06 01:31:12,972 [trainer.py] => model_name: adam_vpt
2023-06-06 01:31:12,972 [trainer.py] => convnet_type: pretrained_vit_b16_224_in21k_vpt
2023-06-06 01:31:12,972 [trainer.py] => device: [device(type='cuda', index=1)]
2023-06-06 01:31:12,972 [trainer.py] => seed: 1993
2023-06-06 01:31:12,972 [trainer.py] => tuned_epoch: 50
2023-06-06 01:31:12,972 [trainer.py] => init_lr: 0.01
2023-06-06 01:31:12,972 [trainer.py] => batch_size: 24
2023-06-06 01:31:12,972 [trainer.py] => weight_decay: 0.0005
2023-06-06 01:31:12,972 [trainer.py] => min_lr: 0
2023-06-06 01:31:12,972 [trainer.py] => optimizer: sgd
2023-06-06 01:31:12,972 [trainer.py] => vpt_type: shallow
2023-06-06 01:31:12,972 [trainer.py] => prompt_token_num: 5
Files already downloaded and verified
Files already downloaded and verified
2023-06-06 01:31:14,095 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
/people/cs/o/oxx220000/.local/lib/python3.9/site-packages/timm/models/_factory.py:114: UserWarning: Mapping deprecated model name vit_base_patch16_224_in21k to current vit_base_patch16_224.augreg_in21k.
  model = create_fn(
This is for the BaseNet initialization.
modelname, pretrained_vit_b16_224_in21k_vpt basicmodelname vit_base_patch16_224_in21k
2023-06-06 01:31:15,377 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg_in21k)
2023-06-06 01:31:15,482 [_hub.py] => [timm/vit_base_patch16_224.augreg_in21k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
Using VPT model
prompt head match
After BaseNet initialization.
2023-06-06 01:31:16,218 [trainer.py] => All params: 85802496
2023-06-06 01:31:16,219 [trainer.py] => Trainable params: 3840
2023-06-06 01:31:16,560 [adam_vpt.py] => Learning on 0-10
85,810,177 total parameters.
11,521 training parameters.
convnet.Prompt_Tokens 3840
fc.weight 7680
fc.sigma 1
  0%|          | 0/50 [00:00<?, ?it/s]Task 0, Epoch 1/50 => Loss 1.755, Train_accy 66.94:   0%|          | 0/50 [00:38<?, ?it/s]Task 0, Epoch 1/50 => Loss 1.755, Train_accy 66.94:   2%|▏         | 1/50 [00:38<31:34, 38.66s/it]Task 0, Epoch 2/50 => Loss 0.831, Train_accy 85.22, Test_accy 97.60:   2%|▏         | 1/50 [01:21<31:34, 38.66s/it]Task 0, Epoch 2/50 => Loss 0.831, Train_accy 85.22, Test_accy 97.60:   4%|▍         | 2/50 [01:21<32:52, 41.10s/it]Task 0, Epoch 3/50 => Loss 0.619, Train_accy 86.26, Test_accy 97.10:   4%|▍         | 2/50 [02:04<32:52, 41.10s/it]Task 0, Epoch 3/50 => Loss 0.619, Train_accy 86.26, Test_accy 97.10:   6%|▌         | 3/50 [02:04<33:02, 42.17s/it]Task 0, Epoch 4/50 => Loss 0.509, Train_accy 88.24, Test_accy 96.70:   6%|▌         | 3/50 [02:48<33:02, 42.17s/it]Task 0, Epoch 4/50 => Loss 0.509, Train_accy 88.24, Test_accy 96.70:   8%|▊         | 4/50 [02:48<32:47, 42.77s/it]Task 0, Epoch 5/50 => Loss 0.479, Train_accy 87.86, Test_accy 97.30:   8%|▊         | 4/50 [03:32<32:47, 42.77s/it]Task 0, Epoch 5/50 => Loss 0.479, Train_accy 87.86, Test_accy 97.30:  10%|█         | 5/50 [03:32<32:17, 43.05s/it]Task 0, Epoch 6/50 => Loss 0.443, Train_accy 88.20:  10%|█         | 5/50 [04:11<32:17, 43.05s/it]                 Task 0, Epoch 6/50 => Loss 0.443, Train_accy 88.20:  12%|█▏        | 6/50 [04:11<30:43, 41.90s/it]Task 0, Epoch 7/50 => Loss 0.429, Train_accy 88.62, Test_accy 97.50:  12%|█▏        | 6/50 [04:55<30:43, 41.90s/it]Task 0, Epoch 7/50 => Loss 0.429, Train_accy 88.62, Test_accy 97.50:  14%|█▍        | 7/50 [04:55<30:23, 42.42s/it]Task 0, Epoch 8/50 => Loss 0.414, Train_accy 89.14, Test_accy 97.40:  14%|█▍        | 7/50 [05:38<30:23, 42.42s/it]Task 0, Epoch 8/50 => Loss 0.414, Train_accy 89.14, Test_accy 97.40:  16%|█▌        | 8/50 [05:38<29:54, 42.72s/it]Task 0, Epoch 9/50 => Loss 0.382, Train_accy 90.04, Test_accy 97.60:  16%|█▌        | 8/50 [06:22<29:54, 42.72s/it]Task 0, Epoch 9/50 => Loss 0.382, Train_accy 90.04, Test_accy 97.60:  18%|█▊        | 9/50 [06:22<29:20, 42.94s/it]Task 0, Epoch 10/50 => Loss 0.368, Train_accy 90.14, Test_accy 97.40:  18%|█▊        | 9/50 [07:05<29:20, 42.94s/it]Task 0, Epoch 10/50 => Loss 0.368, Train_accy 90.14, Test_accy 97.40:  20%|██        | 10/50 [07:05<28:43, 43.08s/it]Task 0, Epoch 11/50 => Loss 0.343, Train_accy 91.32:  20%|██        | 10/50 [07:45<28:43, 43.08s/it]                 Task 0, Epoch 11/50 => Loss 0.343, Train_accy 91.32:  22%|██▏       | 11/50 [07:45<27:18, 42.01s/it]Task 0, Epoch 12/50 => Loss 0.358, Train_accy 89.72, Test_accy 97.20:  22%|██▏       | 11/50 [08:28<27:18, 42.01s/it]Task 0, Epoch 12/50 => Loss 0.358, Train_accy 89.72, Test_accy 97.20:  24%|██▍       | 12/50 [08:28<26:52, 42.44s/it]Task 0, Epoch 13/50 => Loss 0.359, Train_accy 89.64, Test_accy 97.60:  24%|██▍       | 12/50 [09:11<26:52, 42.44s/it]Task 0, Epoch 13/50 => Loss 0.359, Train_accy 89.64, Test_accy 97.60:  26%|██▌       | 13/50 [09:11<26:21, 42.75s/it]Task 0, Epoch 14/50 => Loss 0.336, Train_accy 90.94, Test_accy 97.50:  26%|██▌       | 13/50 [09:55<26:21, 42.75s/it]Task 0, Epoch 14/50 => Loss 0.336, Train_accy 90.94, Test_accy 97.50:  28%|██▊       | 14/50 [09:55<25:47, 42.97s/it]Task 0, Epoch 15/50 => Loss 0.341, Train_accy 90.40, Test_accy 98.00:  28%|██▊       | 14/50 [10:38<25:47, 42.97s/it]Task 0, Epoch 15/50 => Loss 0.341, Train_accy 90.40, Test_accy 98.00:  30%|███       | 15/50 [10:38<25:09, 43.13s/it]Task 0, Epoch 16/50 => Loss 0.330, Train_accy 90.88:  30%|███       | 15/50 [11:18<25:09, 43.13s/it]                 Task 0, Epoch 16/50 => Loss 0.330, Train_accy 90.88:  32%|███▏      | 16/50 [11:18<23:50, 42.08s/it]Task 0, Epoch 17/50 => Loss 0.333, Train_accy 90.76, Test_accy 97.80:  32%|███▏      | 16/50 [12:01<23:50, 42.08s/it]Task 0, Epoch 17/50 => Loss 0.333, Train_accy 90.76, Test_accy 97.80:  34%|███▍      | 17/50 [12:01<23:21, 42.48s/it]Task 0, Epoch 18/50 => Loss 0.351, Train_accy 90.16, Test_accy 97.70:  34%|███▍      | 17/50 [12:45<23:21, 42.48s/it]Task 0, Epoch 18/50 => Loss 0.351, Train_accy 90.16, Test_accy 97.70:  36%|███▌      | 18/50 [12:45<22:48, 42.77s/it]Task 0, Epoch 19/50 => Loss 0.324, Train_accy 91.08, Test_accy 97.80:  36%|███▌      | 18/50 [13:28<22:48, 42.77s/it]Task 0, Epoch 19/50 => Loss 0.324, Train_accy 91.08, Test_accy 97.80:  38%|███▊      | 19/50 [13:28<22:12, 42.98s/it]Task 0, Epoch 20/50 => Loss 0.319, Train_accy 91.08, Test_accy 98.00:  38%|███▊      | 19/50 [14:12<22:12, 42.98s/it]Task 0, Epoch 20/50 => Loss 0.319, Train_accy 91.08, Test_accy 98.00:  40%|████      | 20/50 [14:12<21:33, 43.11s/it]Task 0, Epoch 21/50 => Loss 0.333, Train_accy 90.40:  40%|████      | 20/50 [14:51<21:33, 43.11s/it]                 Task 0, Epoch 21/50 => Loss 0.333, Train_accy 90.40:  42%|████▏     | 21/50 [14:51<20:20, 42.08s/it]Task 0, Epoch 22/50 => Loss 0.312, Train_accy 91.18, Test_accy 97.90:  42%|████▏     | 21/50 [15:36<20:20, 42.08s/it]Task 0, Epoch 22/50 => Loss 0.312, Train_accy 91.18, Test_accy 97.90:  44%|████▍     | 22/50 [15:36<19:57, 42.75s/it]Task 0, Epoch 23/50 => Loss 0.330, Train_accy 90.68, Test_accy 97.70:  44%|████▍     | 22/50 [16:20<19:57, 42.75s/it]Task 0, Epoch 23/50 => Loss 0.330, Train_accy 90.68, Test_accy 97.70:  46%|████▌     | 23/50 [16:20<19:26, 43.19s/it]Task 0, Epoch 24/50 => Loss 0.303, Train_accy 91.16, Test_accy 97.80:  46%|████▌     | 23/50 [17:04<19:26, 43.19s/it]Task 0, Epoch 24/50 => Loss 0.303, Train_accy 91.16, Test_accy 97.80:  48%|████▊     | 24/50 [17:04<18:49, 43.46s/it]Task 0, Epoch 25/50 => Loss 0.315, Train_accy 91.18, Test_accy 97.80:  48%|████▊     | 24/50 [17:48<18:49, 43.46s/it]Task 0, Epoch 25/50 => Loss 0.315, Train_accy 91.18, Test_accy 97.80:  50%|█████     | 25/50 [17:48<18:12, 43.69s/it]Task 0, Epoch 26/50 => Loss 0.320, Train_accy 91.20:  50%|█████     | 25/50 [18:29<18:12, 43.69s/it]                 Task 0, Epoch 26/50 => Loss 0.320, Train_accy 91.20:  52%|█████▏    | 26/50 [18:29<17:05, 42.72s/it]Task 0, Epoch 27/50 => Loss 0.312, Train_accy 90.82, Test_accy 97.90:  52%|█████▏    | 26/50 [19:13<17:05, 42.72s/it]Task 0, Epoch 27/50 => Loss 0.312, Train_accy 90.82, Test_accy 97.90:  54%|█████▍    | 27/50 [19:13<16:34, 43.23s/it]Task 0, Epoch 28/50 => Loss 0.318, Train_accy 90.88, Test_accy 98.00:  54%|█████▍    | 27/50 [19:58<16:34, 43.23s/it]Task 0, Epoch 28/50 => Loss 0.318, Train_accy 90.88, Test_accy 98.00:  56%|█████▌    | 28/50 [19:58<15:59, 43.60s/it]Task 0, Epoch 29/50 => Loss 0.308, Train_accy 91.86, Test_accy 97.80:  56%|█████▌    | 28/50 [20:42<15:59, 43.60s/it]Task 0, Epoch 29/50 => Loss 0.308, Train_accy 91.86, Test_accy 97.80:  58%|█████▊    | 29/50 [20:42<15:19, 43.78s/it]Task 0, Epoch 30/50 => Loss 0.323, Train_accy 90.70, Test_accy 97.90:  58%|█████▊    | 29/50 [21:25<15:19, 43.78s/it]Task 0, Epoch 30/50 => Loss 0.323, Train_accy 90.70, Test_accy 97.90:  60%|██████    | 30/50 [21:25<14:32, 43.63s/it]Task 0, Epoch 31/50 => Loss 0.300, Train_accy 91.40:  60%|██████    | 30/50 [22:05<14:32, 43.63s/it]                 Task 0, Epoch 31/50 => Loss 0.300, Train_accy 91.40:  62%|██████▏   | 31/50 [22:05<13:27, 42.48s/it]Task 0, Epoch 32/50 => Loss 0.316, Train_accy 90.90, Test_accy 97.80:  62%|██████▏   | 31/50 [22:49<13:27, 42.48s/it]Task 0, Epoch 32/50 => Loss 0.316, Train_accy 90.90, Test_accy 97.80:  64%|██████▍   | 32/50 [22:49<12:55, 43.07s/it]Task 0, Epoch 33/50 => Loss 0.303, Train_accy 91.56, Test_accy 98.10:  64%|██████▍   | 32/50 [23:34<12:55, 43.07s/it]Task 0, Epoch 33/50 => Loss 0.303, Train_accy 91.56, Test_accy 98.10:  66%|██████▌   | 33/50 [23:34<12:18, 43.47s/it]Task 0, Epoch 34/50 => Loss 0.299, Train_accy 91.86, Test_accy 97.90:  66%|██████▌   | 33/50 [24:18<12:18, 43.47s/it]Task 0, Epoch 34/50 => Loss 0.299, Train_accy 91.86, Test_accy 97.90:  68%|██████▊   | 34/50 [24:18<11:40, 43.77s/it]Task 0, Epoch 35/50 => Loss 0.297, Train_accy 91.94, Test_accy 98.00:  68%|██████▊   | 34/50 [25:03<11:40, 43.77s/it]Task 0, Epoch 35/50 => Loss 0.297, Train_accy 91.94, Test_accy 98.00:  70%|███████   | 35/50 [25:03<10:59, 43.97s/it]